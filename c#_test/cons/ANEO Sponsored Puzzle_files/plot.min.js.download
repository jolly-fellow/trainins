/*
Plot.js v1.0.0 02/01/2019
http://www.xarg.org/

Copyright (c) 2019, Robert Eisele (robert@xarg.org)
*/
(function(z){function r(a){this._dom=a}function u(a){this._selector=a}function y(a,b,c){this._svg=new u(a);this._dim=[b,c]}r.prototype={_dom:null,attr:function(a,b){if(void 0===b)return this._dom.getAttribute(a);this._dom.setAttribute(a,b);return this},text:function(a){if(void 0===a)return this._dom.innerHTML;this._dom.innerHTML=a;return this},style:function(a,b){if(void 0===b)return this._dom.style[a];this._dom.style[a]=b;return this},append:function(a){a=document.createElementNS("http://www.w3.org/2000/svg",
a);this._dom.appendChild(a);return new r(a)}};u.prototype={_selector:null,_dom:null,init:function(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg","svg");c.setAttribute("width",a);c.setAttribute("height",b);document.querySelector(this._selector).appendChild(c);this._dom=c},append:function(a){a=document.createElementNS("http://www.w3.org/2000/svg",a);this._dom.appendChild(a);return new r(a)},on:function(a,b){switch(a){case "click":case "mousemove":case "mousedown":case "mouseup":var c=
this._dom,e=c.createSVGPoint();this._dom.addEventListener(a,function(a){e.x=a.clientX;e.y=a.clientY;a=e.matrixTransform(c.getScreenCTM().inverse());b(a)});break;default:this._dom.addEventListener(a,b)}}};y.prototype={w:0,h:0,x:0,y:0,resX:30,resY:30,pad:20,_svg:null,_dim:null,init:function(a,b){var c=this._dim[0],e=this._dim[1],d="number"===typeof c?0:c[0],f="number"===typeof c?c:c[1],g="number"===typeof e?0:e[0],h="number"===typeof e?e:e[1];void 0===b&&(b=(a-2*this.pad)*(e[1]-e[0])/(c[1]-c[0])+2*
this.pad);this._svg.init(a,b);this.w=a-2*this.pad;this.h=b-2*this.pad;this.resX=this.w/(f-d);this.resY=this.h/(h-g);this.x=this.w/(2*this.resX)+d;this.y=this.h/(2*this.resY)+g;this.mx=this.w/2-this.x*this.resX;this.my=this.h/2+this.y*this.resY;this.minX=this.x-this.w/(this.resX+this.resX);this.maxX=this.x+this.w/(this.resX+this.resX);this.minY=this.y-this.h/(this.resY+this.resY);this.maxY=this.y+this.h/(this.resY+this.resY);return this},_getX:function(a){return a*this.resX+this.mx+this.pad},_getY:function(a){return-a*
this.resY+this.my+this.pad},getXAbs:function(a){return(a-this.mx-this.pad)/this.resX},getYAbs:function(a){return-(a-this.my-this.pad)/this.resY},circle:function(a){var b=this._svg.append("ellipse");b.attr("cx",this._getX(a.x)).attr("cy",this._getY(a.y)).attr("rx",a.r*this.resX).attr("ry",a.r*this.resY).style("stroke",a.stroke?a.stroke:"none").style("stroke-width",a.lineWidth?a.lineWidth:1).style("fill",a.fill?a.fill:"none");"dashed"===a.lineStyle&&b.style("stroke-dasharray","3,5");var c=this;return{_:b,
attr:function(a,d){switch(a){case "x":b.attr("cx",c._getX(d));break;case "y":b.attr("cy",c._getY(d));break;case "r":b.attr("rx",d*c.resX);b.attr("ry",d*c.resY);break;default:b.attr(a,d)}},style:function(a,d){return b.style(a,d)}}},ellipse:function(a){var b=this._svg.append("ellipse");b.attr("cx",this._getX(a.x)).attr("cy",this._getY(a.y)).attr("rx",a.rx*this.resX).attr("ry",a.ry*this.resY).style("stroke",a.stroke?a.stroke:"none").style("stroke-width",a.lineWidth?a.lineWidth:1).style("fill",a.fill?
a.fill:"none");"dashed"===a.lineStyle&&b.style("stroke-dasharray","3,5");void 0!==a.rotation&&b.style("transform","translate("+this._getX(a.x)+"px, "+this._getY(a.y)+"px) rotate("+a.rotation+"deg) translate(-"+this._getX(a.x)+"px, -"+this._getY(a.y)+"px)");var c=this;return{_:b,attr:function(a,d){switch(a){case "x":b.attr("cx",c._getX(d));break;case "y":b.attr("cy",c._getY(d));break;case "rx":b.attr("rx",d*c.resX);break;case "ry":b.attr("ry",d*c.resY);break;default:b.attr(a,d)}},style:function(a,
d){return b.style(a,d)}}},func:function(a,b){var c=this.minX,e=2/this.resX;b=b||{};var d=[];d.push("M");d.push(this._getX(c));d.push(this._getY(a(c)));do{var f=c+=e;f>this.maxX&&(f=this.maxX);d.push("L");d.push(this._getX(f));d.push(this._getY(a(f)))}while(c<this.maxX);var g=this._svg.append("path");g.attr("d",d.join(" ")).style("fill","none").style("stroke",b.stroke?b.stroke:"#508DF8").style("stroke-width",b.lineWidth?b.lineWidth:2);"dashed"===b.lineStyle&&g.style("stroke-dasharray","3,5");return{_:g,
attr:function(a,b){return g.attr(a,b)},style:function(a,b){return g.style(a,b)}}},poly:function(a,b){var c=[];c.push("M");c.push(this._getX(a[0].x));c.push(this._getY(a[0].y));for(var e=1;e<a.length;e++)c.push("L"),c.push(this._getX(a[e].x)),c.push(this._getY(a[e].y));b.close&&c.push("Z");var d=this._svg.append("path");d.attr("d",c.join(" ")).style("fill",b.fill?b.fill:"none").style("stroke",b.stroke?b.stroke:"black").style("stroke-width",b.lineWidth?b.lineWidth:2);return{_:d,attr:function(a,b){return d.attr(a,
b)},style:function(a,b){return d.style(a,b)}}},line:function(a){var b=this._svg.append("line");b.attr("x1",this._getX(a.x1)).attr("y1",this._getY(a.y1)).attr("x2",this._getX(a.x2)).attr("y2",this._getY(a.y2)).style("stroke",a.stroke?a.stroke:"black").style("fill","none").style("stroke-width",a.lineWidth?a.lineWidth:1);"dashed"===a.lineStyle&&b.style("stroke-dasharray","3,5");var c=this;return{_:b,attr:function(a,d){switch(a){case "x1":b.attr("x1",c._getX(d));break;case "y1":b.attr("y1",c._getY(d));
break;case "x2":b.attr("x2",c._getX(d));break;case "y2":b.attr("y2",c._getY(d));break;default:b.attr(a,d)}},style:function(a,d){return b.style(a,d)}}},spring:function(a){function b(){var b=a.x1,c=a.y1,e=a.x2,h=a.y2,k=a.r,l=a.offset||10,p=a.loops||10,m=e-b,v=h-c,q=Math.sqrt(m*m+v*v),w=m/q;q=v/q;var n=[];n.push("M");n.push(this._getX(b));n.push(this._getY(c));b+=w*l;c+=q*l;e-=w*l;h-=q*l;m=e-b;v=h-c;p=1/p;for(var x=0;x<=1-p;x+=p)for(var t=0;1>t;t+=.05){var r=b+m*(x+t*p),u=c+v*(x+t*p);r-=Math.sin(t*Math.PI*
2)*q*k;u+=Math.sin(t*Math.PI*2)*w*k;n.push(this._getX(r));n.push(this._getY(u))}n.push(this._getX(e));n.push(this._getY(h));n.push(this._getX(e+w*l));n.push(this._getY(h+q*l));return n}var c=this._svg.append("path");c.attr("d",b.call(this).join(" ")).style("fill","none").style("stroke",a.stroke?a.stroke:"black").style("stroke-width",a.lineWidth?a.lineWidth:2);var e=this;return{_:c,style:function(a,b){return c.style(a,b)},attr:function(d,f){switch(d){case "x1":case "y1":case "x2":case "y2":a[d]=f;
c.attr("d",b.call(e));break;default:c.attr(d,f)}}}},arrow:function(a){var b=a.x2-a.x1,c=a.y2-a.y1,e=Math.hypot(b,c),d=this.line({stroke:a.stroke,lineWidth:a.lineWidth,lineStyle:a.lineStyle,x1:a.x1,y1:a.y1,x2:a.x2,y2:a.y2});a.fill=a.stroke;var f=this._addTip(this._svg,a.x2,a.y2,b/e,c/e,.2,a),g=this;return{_:d,style:function(a,b){d.style(a,b);f.style(a,b)},attr:function(b,c){switch(b){case "x1":case "y1":case "x2":case "y2":a[b]=c;var e=a.x2-a.x1,h=a.y2-a.y1,k=Math.hypot(e,h);d.attr(b,c);d.attr("x2",
a.x2);d.attr("y2",a.y2);f.attr("d",g._getTip(a.x2,a.y2,e/k,h/k,.2,a));break;default:d.attr(b,c),f.attr(b,c)}}}},points:function(a,b){var c=this._svg.append("g");b=b||{};for(var e=0;e<a.length;e++){var d=0,f=0,g=a[e];"number"===typeof g?(d=g,f=0):void 0!==g.x?(d=g.x,f=g.y):void 0!==g[0]&&(d=g[0],f=g[1]);c.append("circle").attr("cx",this._getX(d)).attr("cy",this._getY(f)).attr("r",4).style("stroke-width",b.lineWidth?b.lineWidth:1).style("stroke",b.stroke?b.stroke:"none").style("fill",b.stroke?b.stroke:
"#508DF8")}return c},grid:function(a){var b=this._svg.append("g");a=a||{};if(a.labelX){var c=a.labelOffX||{x:0,y:0};this.text({text:a.labelX,x:this.maxX+c.x,y:c.y})}a.labelY&&(c=a.labelOffY||{x:0,y:0},this.text({text:a.labelY,x:c.x,y:this.maxY+c.y}));c=void 0===a.tip||!0===a.tip;var e=void 0===a.scale||!0===a.scale,d=void 0===a.numbers||!0===a.numbers,f=[];f.push("M");f.push(this._getX(0));f.push(this._getY(this.minY));f.push("L");f.push(this._getX(0));f.push(this._getY(this.maxY));f.push("M");f.push(this._getX(this.minX));
f.push(this._getY(0));f.push("L");f.push(this._getX(this.maxX));f.push(this._getY(0));var g=Math.round(15*(this.maxX-this.minX)/this.w*10)/10,h=Math.round(15*(this.maxY-this.minY)/this.h*10)/10;g={incX:g-g%.5+.5,incY:h-h%.5+.5};0===g.incX&&(g.incX=.1);0===g.incY&&(g.incY=.1);0===this.minX&&1===this.maxX&&(g.incX=.1);0===this.minY&&1===this.maxY&&(g.incY=.1);if(e){e=1;for(h=this.minX;c&&h+g.incX<this.maxX||!c&&h<this.maxX;h+=g.incX){var k=2;e++%2&&(k=4,d&&(1E-13<=Math.abs(h)||0===this.minY)&&b.append("text").attr("x",
this._getX(h)-3).attr("y",this._getY(0)+15).text(Math.round(1E3*h)/1E3).style("font-family","sans-serif").style("font-size","10px").style("fill",a.stroke?a.stroke:"#333"));f.push("M");f.push(this._getX(h));f.push(this._getY(0)-k);f.push("L");f.push(this._getX(h));f.push(this._getY(0)+k)}e=1;for(h=this.minY;c&&h<this.maxY||!c&&h<=this.maxY;h+=g.incY)k=2,e++%2&&(k=4,d&&1E-13<=Math.abs(h)&&b.append("text").attr("x",this._getX(0)+8).attr("y",this._getY(h)+4).text(Math.round(1E3*h)/1E3).style("font-family",
"sans-serif").style("font-size","10px").style("fill",a.stroke?a.stroke:"#333")),f.push("M"),f.push(this._getX(0)-k),f.push(this._getY(h)),f.push("L"),f.push(this._getX(0)+k),f.push(this._getY(h))}b.append("path").attr("d",f.join(" ")).style("stroke",a.stroke?a.stroke:"#333");c&&(this._addTip(b,this.maxX,0,1,0,null,null),this._addTip(b,0,this.maxY,0,1,null,null))},_getTip:function(a,b,c,e,d){var f=Math.cos(Math.PI/10),g=Math.sin(Math.PI/10);d=10;a=this._getX(a);b=this._getY(b);return["M",a,b,"L",a-
(c*f-e*g)*d,b+(e*f+c*g)*d,"L",a-(c*f+e*g)*d,b+(e*f-c*g)*d].join(" ")},_addTip:function(a,b,c,e,d,f,g){return a.append("path").attr("d",this._getTip(b,c,e,d,f,g))},text:function(a){var b=this._svg.append("foreignObject").attr("width",300).attr("height",300).attr("x",this._getX(a.x)).attr("y",this._getY(a.y));(function(a,b){for(var c=null,d="",e=0;e<a.length;e++){var k=a.charAt(e),l=a.charAt(e+1);if(c){if("\\"===k&&l===c||"$"===k&&"$"===l&&"$$"===c||"$"===k&&".$"===c){".$"!==c&&(e+=1);c=null;b("math",
d);d="";continue}}else if("\\"===k?"["===l?c="]":"("===a.charAt(e+1)&&(c=")"):"$"===k&&(c="$"===l?"$$":".$"),c){".$"!==c&&(e+=1);b("text",d);d="";continue}d+=k}c?b("math",d):b("text",d)})(a.text,function(a,c){if(c)if("math"===a){var d=document.createElementNS("http://www.w3.org/1999/xhtml","div");d.style.textAlign="left";katex.render(c,d,{throwOnError:!1});b._dom.appendChild(d)}else"text"===a&&b._dom.appendChild(document.createTextNode(c))});var c=this;return{style:function(a,c){b.style(a,c)},attr:function(a,
d){switch(a){case "x":b.attr(a,c._getX(d));break;case "y":b.attr(a,c._getY(d));break;default:b.attr(a,d)}}}},cov:function(a){a=a||{};a.p||(a.p=.95);var b=-2*Math.log(1-a.p),c=a.cov[0][0],e=a.cov[1][0],d=a.cov[1][1],f=a.mu,g=Math.sqrt((c-d)*(c-d)+4*a.cov[0][1]*e);e=[[-(g-c+d)/(2*e),(g+c-d)/(2*e)],[1,1]];g=[Math.sqrt(b*(c+d-g)/2),Math.sqrt(b*(c+d+g)/2)];b=Math.hypot(e[0][0],1);c=Math.hypot(e[0][1],1);e[0][0]/=b;e[1][0]/=b;e[0][1]/=c;e[1][1]/=c;var h=g[0]<g[1]?1:0;b=f[0]+e[0][h]*g[h];c=f[1]+e[1][h]*
g[h];d=f[0]+e[0][1-h]*g[1-h];e=f[1]+e[1][1-h]*g[1-h];g=this._getX(f[0]);h=this._getY(f[1]);var k=Math.hypot(this._getX(b)-g,this._getY(c)-h),l=Math.hypot(this._getX(d)-g,this._getY(e)-h),p=Math.atan2(this._getY(c)-h,this._getX(b)-g);a.strokeAxis&&(this.arrow({x1:f[0],y1:f[1],x2:b,y2:c,lineWidth:2,stroke:a.strokeAxis}),this.arrow({x1:f[0],y1:f[1],x2:d,y2:e,lineWidth:2,stroke:a.strokeAxis}));var m=this._svg.append("ellipse");m.attr("rx",k).attr("ry",l).style("fill","none").style("stroke",a.stroke?a.stroke:
"#508DF8").style("stroke-width",a.lineWidth?a.lineWidth:2).style("transform","translate("+g+"px, "+h+"px) rotate("+p/Math.PI*180+"deg)");"dashed"===a.lineStyle&&m.style("stroke-dasharray","3,5");return{_:m,attr:function(a,b){return m.attr(a,b)},style:function(a,b){return m.style(a,b)}}},arc:function(a){var b=this._svg.append("g");b.append("path").attr("d",this._getArcPath(this._getX(a.x),this._getY(a.y),a.r*this.resX,a.r*this.resY,-a.a1,-a.a2)).style("stroke",a.stroke?a.stroke:"black").style("fill",
"none").style("stroke-width",a.lineWidth?a.lineWidth:1);"dashed"===a.lineStyle&&b.style("stroke-dasharray","3,5");a.tip&&this._addTip(this._svg,a.x+a.r*Math.cos(a.a2),a.y+a.r*Math.sin(a.a2),Math.cos(a.a2+Math.PI/2),Math.sin(a.a2+Math.PI/2),.2,a)},_getArcPath:function(a,b,c,e,d,f){var g={x:a+c*Math.cos(d),y:b+e*Math.sin(d)};a={x:a+c*Math.cos(f),y:b+e*Math.sin(f)};return["M",g.x,g.y,"A",c,e,0,-f+d<=Math.PI?0:1,0,a.x,a.y].join(" ")}};z.Plot=y})(this);